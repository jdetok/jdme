{"version":3,"file":"bld_tbl.js","sourceRoot":"","sources":["../../../ts/src/bball/bld_tbl.ts"],"names":[],"mappings":"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","sourcesContent":["// replaces /www/js/bball/dynamic_table.js\n// dynamic replacement for lg_ldg_scorers.js, rg_ldg_scorer.js, reamrecs.js\n\nimport { foldedLog, MSG } from \"../global.js\";\n\ntype RowFn = (tbl: HTMLTableElement, data: any, idx: number, ) => Promise<void>;\ntype FldSearchFn = (searchFor: string) => Promise<void>;\n\ntype fld<T> = {\n    txt: string;\n    val: (row: T, idx: number) => string;\n    btnFn: FldSearchFn | null;\n}\n\nclass Tbl<T> {\n    el: HTMLTableElement | null = null;\n    elName: string;\n    title: string;\n    hdrs: fld<T>[];\n    rowNum: number;\n    searchFor: string | null;\n    url: string;\n    data: T[] = [];\n    btnFunc: FldSearchFn | null = null;\n\n    constructor(elName: string, ttl: string, rows: number, hdrs: fld<T>[], searchFor: string | null = null, url: string) {\n        this.elName = elName;\n        this.title = ttl;\n        this.rowNum = rows;\n        this.hdrs = hdrs;\n        this.searchFor = searchFor;\n        this.url = url;\n        this.getData();\n        this.build();\n    }\n\n    async getData(): Promise<void>{\n        try {\n            const r = await fetch(this.url);\n            let js = await r.json();\n            this.data = js;\n        } catch (ex) {\n            throw new Error(`failed getting data from ${this.url}: ${ex}`)\n        }\n    }\n\n    build() {\n        let tbl = document.getElementById(this.elName) as HTMLTableElement | null;\n        if (!tbl) throw new Error(`failed to find table element with id: ${this.elName}:`);\n        let tblCapt = this.makeTitle();\n        if (!tblCapt) throw new Error(`failed creating caption: ${this.title}`);\n        tbl.appendChild(tblCapt);\n\n        let hdrRow = this.makeHdrRow();\n        if (!hdrRow) throw new Error(`failed to create header row: ${this.hdrs}`);\n        tbl.appendChild(hdrRow);\n\n        let rows = this.makeRows();\n        if (!rows) throw new Error(`failed to make data rows`);\n        for (let row of rows) {\n            tbl.appendChild(row);\n        }\n    }\n\n    makeTitle(): HTMLTableCaptionElement | null {\n    let capt = document.createElement('caption') as HTMLTableCaptionElement | null;\n        if (!capt) return null\n        capt.textContent = this.title;\n        return capt;\n    }\n\n    makeHdrRow(): HTMLTableSectionElement | null {\n        let thead = document.createElement('thead');\n        for (let hdr of this.hdrs) {\n            let el = document.createElement('td') as HTMLTableCellElement | null;\n            if (!el) return null;\n            el.textContent = hdr.txt;\n            thead.appendChild(el);\n        }\n        return thead;\n    }\n\n    makeRows(): HTMLTableRowElement[] | null {\n        let rows: HTMLTableRowElement[] = [];\n        for (let i = 0; i < this.rowNum; i++) {\n            let row = document.createElement('tr') as HTMLTableRowElement;\n            for (let hdr of this.hdrs) {\n                let cell = document.createElement('td') as HTMLTableCellElement;\n                if (hdr.btnFn) {\n                    let btn = document.createElement('button') as HTMLButtonElement;\n                    btn.textContent = hdr.vals[i];\n                    btn.type = 'button';\n                    if (this.searchFor) {\n                        btn.addEventListener('click', async () => {\n                            await hdr.btnFn!(this.searchFor ?? hdr.vals[i]);\n                        });\n                    }\n                    cell.appendChild(btn);\n                } else {\n                    cell.textContent = hdr.vals[i];\n                }\n                row.appendChild(cell);\n            }\n            rows.push(row);\n        }\n        return rows;\n    }\n}\n\n\nexport async function buildTbl(ttl: string) {\n    const tbl = new Tbl(\n        ttl, [\n            new fld( )\n        ]\n    );\n}\n\n// build full table\nexport async function buildTableWithHdr(data: any, element_id: string, title: string,\n    fields: string[], rows_to_display: number, rowfunc: RowFn | null\n): Promise<void> {\n    foldedLog(`%cbuilding table from object with keys: ${Object.keys(data)}...`, MSG);\n\n    const tbl = document.getElementById(element_id) as HTMLTableElement | null;\n    if (!tbl) throw new Error(`no table element found with element ${element_id}`);\n    tbl.textContent = \"\";    \n\n    let capt = getTblCaption(title);\n    if (!capt) {\n        throw new Error(`failed making table caption from passed title {${title}}`);\n    }\n    tbl.appendChild(capt);\n\n    let hdr = getTblHdrRow(fields);\n    if (!hdr) {\n        throw new Error(`failed making header row passed fields: {${console.table(fields)}}`);\n    }\n    tbl.appendChild(hdr);\n    \n    // build each row\n    for (let i = 0; i < rows_to_display; i++) {\n        if (rowfunc) {\n            await rowfunc(tbl, data, i);\n        } else {\n            let row = getTblDataRow();\n        }\n        \n    }\n}\n\nfunction getTblCaption(title: string): HTMLTableCaptionElement | null {\n    let capt = document.createElement('caption') as HTMLTableCaptionElement | null;\n    if (!capt) return null\n    capt.textContent = title;\n    return capt;\n}\n\nfunction getTblHdrRow(fields: string[]): HTMLTableSectionElement | null {\n    let thead = document.createElement('thead');\n    for (let fld of fields) {\n        let el = document.createElement('td') as HTMLTableCellElement | null;\n        if (!el) return null;\n        el.textContent = fld;\n        thead.appendChild(el);\n    }\n    return thead;\n}\ntype CellData = {hdr: string, data: string};\n\nfunction getTblDataRow(idx: number, cells: CellData[]): HTMLTableRowElement | null {\n    let row = document.createElement('tr') as HTMLTableRowElement | null;\n    if (!row) return null;\n    for (let cell of cells) {\n        let el = document.createElement('td') as HTMLTableCellElement | null \n        if (!el) return null;\n        el.textContent = cell.data;\n        row.appendChild(el);\n    }\n    return row;\n}\n\n"]}