{"version":3,"file":"player.js","sourceRoot":"","sources":["../../../ts/src/bball/player.ts"],"names":[],"mappings":"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","sourcesContent":["import { base, scrollIntoBySize, MSG, foldedLog, MSG_BOLD, RED_BOLD, foldedErr, logResp } from \"../global.js\";\nimport { makeTmPlrImageDiv } from \"./elements.js\";\nimport { fillImageDiv } from \"./img.js\";\nimport { setPHold, getInputVals } from \"./inputs.js\";\nimport { RGData, PlayerResp, PlayersResp, playerMeta } from \"./resp_types.js\";\nimport { tblColHdrs, tblRowColHdrs } from \"./tbls_resp.js\";\n\nexport async function buildOnLoadDash(rgData: RGData) {\n    try {\n        await searchPlayer('onload', null, rgData);\n    } catch (e) {\n        throw new Error(`error building onload dash: ${e}`);\n    }\n}\n\ntype PlayerSearchType = 'onload' | 'random' | 'submit' | 'button';\nexport async function searchPlayer(pst: PlayerSearchType = 'submit',\n    playerOverride: string | null = null, rgData?: RGData\n): Promise<void> {\n    const searchElId = 'pSearch';\n    const input = document.getElementById(searchElId) as HTMLInputElement;\n    if (!input) throw new Error(`couldn't get element at Id ${searchElId}`);\n    let player = '';\n    const { lg, season, team } = await getInputVals();\n    switch (pst) {\n        case 'onload':\n            if (!rgData) throw new Error(`%cmust pass recent game data for onload mode`) \n            player = rgData.top_scorers[0].player;\n            foldedLog(`%cfetched onload player ${player} | league: ${lg} | season ${season}`, MSG);\n            break;\n        case 'submit': \n            player = input.value.trim();\n            break;\n        case 'random': \n            foldedLog(`%csearching random player | league: ${lg} | season ${season}`, MSG);\n            player = String(pst);\n            break;\n        case 'button':\n            foldedLog(`%cfetching player ${player} from button | league: ${lg} | season ${season}`, MSG);\n            if (!playerOverride) throw new Error(`cplayerOverride must be passed if called with pst='button'`);\n            player = playerOverride;\n            break;        \n        default: \n            foldedLog(`%coption passed as pst \"${pst} not valid`, RED_BOLD);\n            return;\n    }\n    if (player === '') {\n        const pHoldElId = 'pHold';\n        const pHoldEl =  document.getElementById(pHoldElId) as HTMLInputElement;\n        player = pHoldEl.value;\n    }\n\n    foldedLog(`%csearching for player ${player} | season ${season} | team ${team} | league ${lg}`, MSG_BOLD);\n\n    const recent_data = rgData ?? null;\n\n    // build response player dash section\n    try {\n        const data = await fetchPlayer(base, player, season, team, lg);\n        if (!data) throw new Error(`failed to get data for player ${player} | season ${season} | team ${team}`);\n        await setPHold(data.player[0].player_meta.player);\n        await buildPlayerDash(data.player[0], recent_data);\n    } catch (e) {\n        throw new Error(`error fetching data or building dash: ${e}`);\n    }\n    if (pst !== 'onload') scrollIntoBySize(1350, 1250, \"player_title\");\n}\n\nexport async function fetchPlayer(base: string, player: string | number, \n    season: string | number, team: string | number, lg: string, errEl = 'sErr'\n): Promise<PlayersResp> {\n    const errmsg = document.getElementById(errEl);\n    if (!errmsg) throw new Error(`%ccould not find error string element at ${errEl}`);\n    if (errmsg.style.display === \"block\") {\n        errmsg.style.display = 'none';\n    }\n\n    const s = encodeURIComponent(season);\n    const p = encodeURIComponent(player).toLowerCase();\n    const url = `${base}/v2/players?player=${p}&season=${s}&team=${team}&league=${lg}`;\n    let r: Response;\n    \n    try {\n        r = await fetch(url);\n        if (!r.ok) {\n            errmsg.textContent = `can't find ${player}`;\n            errmsg.style.display = \"block\";\n            console.error(`an error occured attempting to fetch ${player}\\n`);\n            throw new Error(`HTTP Error (${r.status}) attempting to fetch ${player}`);\n        }\n    } catch (e) {\n        throw new Error(`fetch player error: ${e}`);\n    }\n    // foldedLog(`%c${await bytes_in_resp(r)} bytes received from ${url}}`, MSG)\n    await logResp(url, r);\n    return await r.json() as Promise<PlayersResp>;\n}\n\nexport type TopScorer = RGData | null;\n\n// accept player dash data, build tables/fetch images and display on screen\nexport async function buildPlayerDash(data: PlayerResp, ts: TopScorer): Promise<void> {\n    try {\n        \n        await fillImageDiv(makeTmPlrImageDiv('dash_imgs', {\n            tm_url: data.player_meta.team_logo_url,\n            tm: data.player_meta.team,\n            plr_url: data.player_meta.headshot_url,\n            plr: data.player_meta.player,\n        }));\n\n        await respPlayerTitle(data.player_meta, 'resp_ttl', ts);\n        await respPlayerInfo(data, 'resp_subttl');\n\n        // box stat tables\n        await tblColHdrs(data.totals.box_stats, data.player_meta.cap_box_tot, 'box_tot');\n        await tblColHdrs(data.per_game.box_stats, data.player_meta.cap_box_avg, 'box_avg');\n\n        // shooting stats tables\n        await tblRowColHdrs(data.totals.shooting, data.player_meta.cap_shtg_tot, 'shot type', 'stg_tot');\n        await tblRowColHdrs(data.per_game.shooting, data.player_meta.cap_shtg_avg, 'shot type', 'stg_avg');\n    } catch (e) {\n        foldedErr(`error building ${ts ? 'top scorer' : ''} player dash for ${data.player_meta.player}: ${e}`);\n        return;\n    }\n    foldedLog(`%cbuilt ${ts ? 'top scorer' : ''} player dash for ${data.player_meta.player}`, MSG);\n}\n\n// ts is nothing \n// in that case, ts exists and should be the object returned from /games/recent\nasync function respPlayerTitle(data: playerMeta, elId: string, ts: TopScorer) {\n    const rTitle = document.getElementById(elId);\n\n    if (!rTitle) throw new Error(`couldnt' get response title element at ${elId}`);\n\n    if (ts) {\n        rTitle.innerHTML = `\n        Top Scorer from ${ts.recent_games[0].game_date}<br>${data.caption}\n         | ${ts.top_scorers[0].points} pts | \n         ${ts.top_scorers[0].assists} ast |\n         ${ts.top_scorers[0].rebounds} reb`;    \n    } else {\n        rTitle.textContent = data.caption;\n    }\n}\n\nasync function respPlayerInfo(data: PlayerResp, elId: string) {\n    const cont = document.getElementById(elId);\n    if (!cont) throw new Error(`couldnt' get response title element at ${elId}`);\n    cont.textContent = '';\n    const d = document.createElement('div');\n    const s = document.createElement('h2');\n    const u = document.createElement('h3');\n    s.textContent = data.player_meta.season;\n    u.textContent = `${data.playtime.games_played} Games Played | \n        ${data.playtime.minutes} Minutes | \n        ${data.playtime.minutes_pg} Minutes/Game`;\n    d.appendChild(s);\n    d.appendChild(u);\n    cont.appendChild(d);\n}\n\nexport async function appendImg(url: string, elId: string) {\n    const pEl = document.getElementById(elId);\n    if (!pEl) throw new Error(`couldnt' get response title element at ${elId}`);\n    const img = document.createElement('img');\n    pEl.textContent = '';\n    img.src = url;\n    img.alt = \"image not found\";\n    pEl.append(img);\n}\n\n"]}