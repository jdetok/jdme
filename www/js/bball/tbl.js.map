{"version":3,"file":"tbl.js","sourceRoot":"","sources":["../../../ts/src/bball/tbl.ts"],"names":[],"mappings":"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","sourcesContent":["// replaces /www/js/bball/dynamic_table.js\n// dynamic replacement for lg_ldg_scorers.js, rg_ldg_scorer.js, reamrecs.js\n\nimport { foldedLog, MSG } from \"../global.js\";\n\ntype CellValue<T> = (data: T | any, idx: number) => string;\n\ntype Column<T> = {\n    header: string;\n    value: CellValue<T>;\n    button?: {\n        onClick: (value: string, data: T, idx: number) => Promise<void>;\n    };\n};\n\nexport class Tbl<T> {\n    private data!: T;\n\n    constructor(\n        private elId: string,\n        private title: string,\n        private rowCount: number,\n        private url: string,\n        private columns: Column<T>[],\n    ) {}\n\n    async init(): Promise<void> {\n        const r = await fetch(this.url);\n        this.data = await r.json();\n        this.build();\n    }\n\n    private build(): void {\n        let tbl = document.getElementById(this.elId) as HTMLTableElement;\n        tbl.innerHTML = '';\n\n        tbl.appendChild(this.makeTitle());\n\n        tbl.appendChild(this.makeHdrRow());\n\n        for (let i = 0; i < this.rowCount; i++) {\n            tbl.appendChild(this.makeRow(i));\n        }\n    }\n\n    makeTitle(): HTMLTableCaptionElement {\n    let capt = document.createElement('caption') as HTMLTableCaptionElement;\n        capt.textContent = this.title;\n        return capt;\n    }\n\n    makeHdrRow(): HTMLTableSectionElement {\n        const thead = document.createElement('thead');\n        const tr = document.createElement('tr');\n        for (const col of this.columns) {\n            const td = document.createElement('td');\n            td.textContent = col.header;\n            tr.appendChild(td);\n        }\n        thead.appendChild(tr);\n        return thead;\n    }\n\n    makeRow(idx: number): HTMLTableRowElement {\n        const tr = document.createElement(\"tr\");\n\n        this.columns.forEach(col => {\n            const td = document.createElement('td');\n            const val = col.value(this.data, idx);\n            if (col.button) {\n                const btn = document.createElement(\"button\");\n                btn.type = \"button\";\n                btn.textContent = val;\n                btn.onclick = () => col.button!.onClick(val, this.data, idx);\n                td.appendChild(btn);\n            } else {\n                td.textContent = val;\n            }\n\n            tr.appendChild(td);\n        })\n        return tr;\n    }\n}"]}